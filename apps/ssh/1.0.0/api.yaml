walkoff_version: 1.0.0
app_version: 1.0.0
name: ssh:1.0.0
description: Executes ssh shell commands via SSH
contact_info:
  name: Walkoff Team
  url: https://github.com/nsacyber/walkoff
  email: walkoff@nsa.gov
license_info:
  name: Creative Commons
  url: https://github.com/nsacyber/WALKOFF/blob/master/LICENSE.md
actions:
  - name: exec_command
    description: Execute command on remote server with SSH client
    parameters:
      - name: hosts
        schema:
          type: array
        description: hosts or hostnames of the remote server
        required: true
      - name: port
        schema:
          type: integer
          minimum: 1
          maximum: 65535
        description: port number
        required: true
      - name: args
        required: true
        schema:
          type: array
        description: json array of arguments
      - name: username
        schema:
          type: string
        description: username to login with
        required: true
      - name: password
        schema:
          type: string
        description: password to login with
        required: true
    returns:
      schema:
        type: string
  - name: sftp_copy
    description: Copy remote file to remote host using sftp
    parameters:
      - name: src_path
        required: true
        schema:
          type: string
        description: source path of the file to copy
      - name: dest_path
        required: true
        schema:
          type: string
        description: remote path of the file destination
      - name: src_host
        schema:
          type: string
        description: host or hostname of the remote server
        required: true
      - name: src_port
        schema:
          type: integer
          minimum: 1
          maximum: 65535
        description: port number
        required: true
      - name: src_username
        schema:
          type: string
        description: username to login with
        required: true
      - name: src_password
        schema:
          type: string
        description: password to login with
        required: true
      - name: dest_host
        schema:
          type: string
        description: host or hostname of the remote server
        required: true
      - name: dest_port
        schema:
          type: integer
          minimum: 1
          maximum: 65535
        description: port number
        required: true
      - name: dest_username
        schema:
          type: string
        description: username to login with
        required: true
      - name: dest_password
        schema:
          type: string
        description: password to login with
        required: true
    returns:
      schema:
        type: string
  - name: run_shell_script_file
    description: runs the specified shell script on the remote server(s)
    parameters:
      - name: local_file_name
        required: true
        schema:
          type: string
        description: local path of the shell script to run
      - name: hosts
        schema:
          type: array
        description: hosts of the remote server
        required: true
      - name: port
        schema:
          type: integer
          minimum: 1
          maximum: 65535
        description: port number
        required: true
      - name: username
        schema:
          type: string
        description: username to login with
        required: true
      - name: password
        schema:
          type: string
        description: password to login with
        required: true
    returns:
      schema:
        type: string
  - name: block_ips
    description: runs the specified shell script on the remote server
    parameters:
      - name: ips
        required: true
        schema:
          type: array
        description: local path of the shell script to run
      - name: host
        schema:
          type: string
        description: host or hostname of the remote server
        required: true
      - name: port
        schema:
          type: integer
          minimum: 1
          maximum: 65535
        description: port number
        required: true
      - name: username
        schema:
          type: string
        description: username to login with
        required: true
      - name: password
        schema:
          type: string
        description: password to login with
        required: true
    returns:
      schema:
        type: string
  - name: close_connection
    description: closes the SSH connection
    parameters:
      - name: host
        schema:
          type: string
        description: host or hostname of the remote server
        required: true
      - name: port
        schema:
          type: integer
          minimum: 1
          maximum: 65535
        description: port number
        required: true
      - name: username
        schema:
          type: string
        description: username to login with
        required: true
      - name: password
        schema:
          type: string
        description: password to login with
        required: true
    returns:
      schema:
        type: boolean

