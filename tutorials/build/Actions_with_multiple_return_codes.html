<!DOCTYPE html>
<html>
<title>WALKOFF-Automation for All</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../../w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/androidstudio.min.css">
<style>

body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif}
.w3-navbar,h1,button {font-family: "Montserrat", sans-serif}
.fa-graduation-cap,.fa-flask{font-size:200px}

#headerDiv{
    background-image:url("../../files/images/headerBackground2.png");
    background-size: 50% auto;
    background-repeat: no-repeat;
    background-position:50% 50%;
}

.imageList {
  list-style-type: none;
}

.topLevelList + h5{
  display:none;
}

.fa-circle, .fa-circle-o{
  font-size:12px;
  padding-right:10px;
}

.code{
    background-color:#edf0f4;
    padding:25px;
}


td{
    padding-right:10px;
    margin-bottom: 25px;
    margin-top:25px;
}

.image{
    text-align:center;
}

.image img{
    max-width:100%;
    max-height:100%;
}

.functionality_list li{
    margin-bottom:20px;
}

.tag{
    background-color:#edf0f4;
    text-align:center;
}

img.media-object.image{
    width:100%;
}

.tutorialTable td{
    border-bottom:1px solid black;
}

</style>
<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
    
<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-blue-grey w3-card-2 w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-opennav w3-right w3-padding-large w3-hover-white w3-large w3-red" href="javascript:void(0);" onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
    <a href="../../index.html" class="w3-bar-item w3-button w3-padding-large w3-white">Home</a>
    <a href="../../documentation/build/index.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Documentation</a>
    <a href="https://github.com/iadgov/WALKOFF" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Source</a>
    <a href="../../swagger/index.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">API</a>
    <a href="index.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Tutorials</a>
  </div>

  <!-- Navbar on small screens -->
  <div id="navDemo" class="w3-navblock w3-white w3-hide w3-hide-large w3-hide-medium w3-large">
    <a class="w3-padding-large" href="../../documentation/build/index.html">Documentation</a>
    <a class="w3-padding-large" href="https://github.com/iadgov/WALKOFF">Source</a>
    <a class="w3-padding-large" href="../../swagger/index.html">API</a>
    <a class="w3-padding-large" href="index.html">Tutorials</a>
  </div>
</div>

<!-- Header -->
<header id="headerDiv" class="w3-container w3-black w3-center w3-padding-64">
  <h1 class="headerText w3-margin w3-jumbo">WALKOFF</h1>
  <h5 class="headerText w3-margin w3-xxxlarge">Tutorials</h5>
</header>

<div class="w3-row-padding w3-padding-64 w3-container">
    <div class="w3-content">
        <div class="w3-twothird">
            <h1>Return codes for actions</h1>
            <p>Up to this point, all of our actions have had a single entry named <code>Success</code> in the <code>returns</code>
                field of their api YAML file. But WALKOFF can support multiple return codes. Think of them like HTTP
                response codes (200, 404, 400, 500) for your action. In fact, how Flask manages return codes for HTTP
                messages was the inspiration for this feature. These return codes can be used for selecting an
                appropriate next step in your workflow.</p>
            <p>The default return code for an action is <b>Success</b>. In addition to this return code, there are also
                the <b>UnhandledException</b> and <b>InvalidInput</b> return codes which respectively occur when an
                exception is thrown by your action or the input to your action is invalidated against the schema in the
                YAML metadata file for your app. These return codes are reserved by WALKOFF and cannot be used as your
                return codes. To mark your own return codes as failure states, use the <code>failure</code> return
                property.</p>
            <p>By default, if you don't explicitly specify a return code in your return statement of your action, the
                Success code is used. You can also set your own default return code with the <code>default_return</code>
                action property.</p>
            <p>With all that being said, let's make an action which returns multiple return codes. For our use case
                let's suppose we are making an HTTP request to a URL which is going to return a status indicating if a
                resource is offline or online, meaning it's return a response which contains a JSON with a single field
                called "status". We want the ability to take one step after this action if the resource is online and a
                different step if the resource is offline. Setting the Online return code as the default will make any
                branches created from the action default to that status code. We will also mark the Offline return code
                as a failure code so that it the action turns red if it is returned. Our action would look like
                this:</p>
            <pre><code class="python">
from apps import App, action
import requests
from datetime import datetime

class Main(App):
    # ... Other actions ...

    @action
    def is_online(self):
        response = requests.get('http:/some/path/here').json()
        if response['status'] == 'online':
            return str(datetime.utcnow()), 'Online'
        else:
            return str(datetime.utcnow()), 'Offline'
        </code></pre>
            <p>This function simply returns a UTC time when the action was completed as the return value and a status as
                the return code.</p>
            <p>Now to specify the return codes in the YAML metadata file, we can write the following:</p>
            <pre><code class="yaml">
actions:
  hello world:
    run: hello_world
    default_return: Online
    returns:
      Online:
        schema:
          type: string
      Offline:
        failure: true
        schema:
          type: string
        </code></pre>
            <div align="center" style="border:1px solid blue">
                <h5><a href="Manage_app_dependencies.html">Next >></a></h5>
            </div>
        <ol>
            <li><a href="Develop_an_app.html">Develop an App</a></li>
            <li><a href="Develop_an_app_with_class.html">Develop an App with Devices</a></li>
            <li><a href="Develop_conditions_transforms.html">Develop Conditions and Transforms</a></li>
            <li><a href="App_api_schema.html">App API Schema Examples</a></li>
            <li><a href="Develop_messaging_actions.html">Develop messaging actions</a></li>
            <li><a href="Manage_app_dependencies.html">Managing App Dependencies</a></li>
            <li><a href="Test_an_app.html">Testing an App</a></li>
        </ol>
    </div>

        <div class="w3-third w3-center">
            <i class="fa fa-graduation-cap w3-padding-64 w3-text-blue-grey"></i>
        </div>
    </div>
</div>

<div class="w3-container w3-black w3-center w3-opacity w3-padding-64">
    <h1 class="w3-margin w3-xlarge">Questions? Comments? </h1>
    <h1 class="w3-margin w3-xlarge"> Reach out to us at <a href="mailto:walkoff@nsa.gov"> walkoff@nsa.gov </a> </h1>
</div>

<!-- Footer -->
<footer class="w3-container w3-padding-64 w3-center w3-opacity">
 <!-- <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank"> </a></p> -->
</footer>

<script src="../../files/plugins/jQuery/jQuery-2.1.4.min.js"></script>
<script>
// Used to toggle the menu on small screens when clicking on the menu button
function myFunction() {
    var x = document.getElementById("navDemo");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>
</body>
</html>
