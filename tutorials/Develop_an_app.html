<!DOCTYPE html>
<html>
<title>WALKOFF-Automation for All</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif}
.w3-navbar,h1,button {font-family: "Montserrat", sans-serif}
.fa-graduation-cap,.fa-flask{font-size:200px}
#headerDiv{
    background-image:url("../files/images/headerBackground2.png");
    background-size: 50% auto;
    background-repeat: no-repeat;
    background-position:50% 50%;
}
.topLevelList + ol{
  display:none;
}
.topLevelList + h5{
  display:none;
}
.fa-circle, .fa-circle-o{
  font-size:12px;
  padding-right:10px;
}
</style>
<body>

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-blue-grey w3-card-2 w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-opennav w3-right w3-padding-large w3-hover-white w3-large w3-red" href="javascript:void(0);" onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
    <a href="../index.html" class="w3-bar-item w3-button w3-padding-large w3-white">Home</a>
    <a href="https://iadgov.github.io/WALKOFF/documentation.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Version One</a>
    <a href="../documentationVersionTwo.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Version Two</a>
    <a href="https://github.com/iadgov/WALKOFF" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Source</a>
    <a href="index.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Tutorials</a>
  </div>

  <!-- Navbar on small screens -->
  <div id="navDemo" class="w3-navblock w3-white w3-hide w3-hide-large w3-hide-medium w3-large">
    <a class="w3-padding-large" href="https://iadgov.github.io/WALKOFF/documentation.html">Version One</a>
    <a class="w3-padding-large" href="../documentationVersionTwo.html">Version Two</a>
    <a class="w3-padding-large" href="https://github.com/iadgov/WALKOFF">Source</a>
    <a class="w3-padding-large" href="index.html">Tutorials</a>
  </div>
</div>

<!-- Header -->
<header id="headerDiv" class="w3-container w3-black w3-center w3-padding-64">
  <h1 class="headerText w3-margin w3-jumbo">WALKOFF</h1>
  <h5 class="headerText w3-margin w3-xxxlarge">Tutorials</h5>
</header>

<!-- First Grid -->
<div class="w3-row-padding w3-padding-64 w3-container">
  <div class="w3-content">
    <div class="w3-twothird">
      <h1>Develop an app</h1>
         <h2 class="w3-padding-32">Step one: Write the actions</a></h2>
        <h4><b>1. Create a Python package in the apps directory with the name of the app you want to create.</b></h4>
        <p>In this example we will be recreating the some of the functions of the HelloWorld App in the apps directory,
            so we'll call our package HelloWorld. The <code>apps</code> directory should look like this:</p>
        <pre><code>
WALKOFF
|-- apps
  |-- __init__.py
  |-- HelloWorld
    |-- __init__.py
  |-- [Other apps]
        </code></pre>
        <p>The <code>__init__.py</code> can just be an empty file</p>

        <h4><b>2. Create a basic Main class inside of <code>main.py</code></b></h4>
        <p>Inside of the HelloWorld package, we need to create a <code>main.py</code> module. Inside of this module,
        we will define a class called <code>Main</code> which will extend the <code>App</code> class from
            <code>server.appdevice</code> module. This class is the primary interface to the WALKOFF orchestrator.
        There are only two requirements for this class: </p>
        <ol>
            <li>The <code>__init__</code> must take a name and a device parameters</li>
            <li>A method named shutdown must be implemented</li>
        </ol>
        <p>The first requirement is needed to initialize the App's base class, and the shutdown method will handle
           any cleanup is necessary to terminate a session with the app. In our example, we won't need any
           shutdown procedures, so we'll just make that function empty</p>

        <pre><code>
from server.appdevice import App

class Main(App):
    def __init__(self, name, device):
        App.__init__(self, name, device)

    def shutdown(self):
        pass
        </code></pre>

        <h4><b>3. Write some methods</b></h4>
        <p>Each method you write in this class can be turned into an action. Each method must be able to be
            called with a named "args" parameter. So the method signature can either be </p>
        <pre>
<code>def my_func(self, args={}): pass</code>
<b><i>or</i></b>
<code>def my_func(self, **kwargs): pass</code>
        </pre>
            <p>
                The <code>args</code> parameter will be a dictionary whose key-value pairs are describe the argument
                name and value. </p>
            <p><i>Note: the value will be in the form of an Argument object. This object is callable,
                so to use a value you must call it using <code>args['argname']()</code></i></p>
            <p>
                Now to write our functions. We are going to write a the standard "Hello World" action as well as an action
                which takes an argument named "number" and increments it by one and converts it to a string.
            </p>
            <pre><code>
from server.appdevice import App

class Main(App):
    def __init__(self, name, device):
        App.__init__(self, name, device)

    def hello_world(self, args={}):
        return {"message": "Hello World"}

    def plus_one(self, args={}):
        return str(args["number"]() + 1)

    def shutdown(self):
        pass
            </code></pre>


        <h4><b>4. Create the <code>functions.json</code> JSON metadata file to convert the methods to actions</b></h4>
        <p>For WALKOFF to recognize a method as an action, it must have an entry in the apps's function.json file,
            which is located in the app directory. The minimum required entry of the functions.json is as follows:</p>
        <pre><code>
{
    "method_name": {
        "description": "Short description of what the action does"
        "args": [
            {
                "name": "argument name"
                "type": "data type (currently str, unicode, or int)"
            }
        ]
    }
}
        </code></pre>
        <p>For our basic app, our <code>functions.json</code> file will look like the following:</p>
        <pre><code>
{
    "hello_world": {
        "description": "Say hello"
        "args": []
    }
    "plus_one": {
        "description": "Returns plus one"
        "args": [
            {
                "name": "number"
                "type": "int"
            }
        ]
    }
}
        </code></pre>
        <p>There are more fields available in the JSON metadata file. And if you are concerned if your functions.json
            file is correct, you can do a quick scan by running the <code>validateappfunctions.py</code> script included
            at the root of the WALKOFF repository. You can validate your app's functions.json by running</p>
            <pre><code>
python validateappfunctions.py --apps HelloWorld
            </code></pre>
        <p>You can see more options using </p>
        <pre><code>
python validateappfunctions.py --help
        </code></pre>
        <h4><b>Congratulations! You now have made your first WALKOFF app.</b></h4>
        <p>Go have a look in the webapp and see the name of your app included in the "Installed Apps" portion of the
            dashboard and see the actions you defined included in the workflow editor. Next, you'll learn how to make a
            custom interface for your app (right now the server will quietly complain if you try to display your app)</p>
        <div align="center" style="border:1px solid blue">
            <h5><a href="Develop_an_app_interface.html">Next >></a></h5>
        </div>
    </div>

   <div class="w3-third w3-center">
      <i class="fa fa-graduation-cap w3-padding-64 w3-text-blue-grey"></i>
    </div>
  </div>
</div>

<div class="w3-container w3-black w3-center w3-opacity w3-padding-64">
    <h1 class="w3-margin w3-xlarge">Questions? Comments? </h1>
    <h1 class="w3-margin w3-xlarge"> Reach out to us at <a href="mailto:walkoff@nsa.gov"> walkoff@nsa.gov </a> </h1>
</div>

<!-- Footer -->
<footer class="w3-container w3-padding-64 w3-center w3-opacity">
 <!-- <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank"> </a></p> -->
</footer>

<script src="../files/plugins/jQuery/jQuery-2.1.4.min.js"></script>
<script>
// Used to toggle the menu on small screens when clicking on the menu button
function myFunction() {
    var x = document.getElementById("navDemo");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else {
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>
</body>
</html>